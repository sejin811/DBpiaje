<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBpiaje | Main Page</title>
    <link rel="icon" href="img/pepe.jpeg" type="image/png">
    <!-- CSS파일 연결 -->
    <!-- 캐시 무효화 버전 -->
    <link rel="stylesheet" href="style1.css?v=1.0.3">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        .banner {
            background-image: url('https://img.freepik.com/fotos-kostenlos/welliger-schwarz-weisser-hintergrund_23-2150530917.jpg?semt=ais_hybrid&w=740');
            background-size: cover;
            background-position: center;
            color: rgb(255, 0, 0);
            text-align: center;
            font-family: Arial, sans-serif;

            /* 가로로 길고 얇은 배너 */
            height: 120px;
            /* 원하는 높이로 조절 */
            width: 100%;

            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;

            padding: 0;
            margin: 0;
        }

        .banner h1 {
            font-size: 4rem;
            margin: 0;
        }

        .banner p {
            font-size: 1rem;
            margin: 5px 0 0 0;
        }

        /* 모바일 대응 */
        @media (max-width: 600px) {
            .banner {
                height: 100px;
            }

            .banner h1 {
                font-size: 7vw;
            }

            .banner p {
                font-size: 0.9rem;
            }
        }

        .collapse-btn {
            margin: 10px 20px;
            padding: 6px 12px;
            background-color: #2a6ed1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .collapse-btn:hover {
            background-color: #1d56aa;
        }

        body.dark-mode .collapse-btn {
            background-color: #444;
            color: #f0f0f0;
        }

        body.dark-mode .collapse-btn:hover {
            background-color: #555;
        }

        /* 접힌 상태 */
        .music-bar.collapsed {
            display: none;
        }
    </style>

    <!--노래틀기 스타일 시트-->
    <link rel="stylesheet" href="communityPage/css/music.css">

    <!-- 게시물 스타일 시트 -->
    <link rel="stylesheet" href="communityPage/css/posts.css">

    <!-- 사진 업로드 버튼 -->
    <link rel="stylesheet" href="communityPage/css/photo_upload.css">

    <!-- 좋아요 버튼 (다크모드)스타일 시트 -->
    <link rel="stylesheet" href="communityPage/css/good_btn.css">

    <!-- 관리자 삭제 팝업 창 스타일 시트 (오류날까봐 따로 둠)-->
    <link rel="stylesheet" href="communityPage/css/admin-posts-delete.css">

    <!-- 공지사항 팝업 모달 창 css-->
    <style>
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .popup-box {
            background: white;
            padding: 40px 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            animation: popup-fadein 0.3s ease;
        }

        .popup-box h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .popup-box p {
            font-size: 1.1rem;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .popup-box button {
            margin: 5px;
            padding: 10px 20px;
            background-color: #2a6ed1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s ease;
        }

        .popup-box button:hover {
            background-color: #1d56aa;
        }

        @keyframes popup-fadein {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* 기존 팝업 스타일은 그대로 유지한 채, 다크모드일 때를 아래에 추가 */
        body.dark-mode .popup-box {
            background: #222;
            /* 어두운 배경 */
            color: #f0f0f0;
            /* 밝은 텍스트 */
            box-shadow: 0 8px 20px rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .popup-box button {
            background-color: #444;
            color: #f0f0f0;
        }

        body.dark-mode .popup-box button:hover {
            background-color: #555;
        }

        @media (max-width: 600px) {
            .popup-box {
                width: 95%;
                padding: 30px 20px;
                font-size: 0.95rem;
            }

            .popup-box h2 {
                font-size: 1.4rem;
            }

            .popup-box p {
                font-size: 1rem;
            }

            .popup-box button {
                font-size: 0.95rem;
                padding: 8px 16px;
            }
        }
    </style>

    <!-- 최신순/오래된 순 버튼-->
    <style>
        .sort-buttons {
            text-align: center;
            margin: 10px 0;
        }

        .sort-buttons button {
            background-color: #f0f0f0;
            color: #333;
            border: 1px solid #ccc;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .sort-buttons button:hover {
            background-color: #e0e0e0;
        }

        .sort-buttons button.active {
            background-color: #f0f0f0;
            color: #333;
            border-color: #ccc;
        }
    </style>

</head>

<body>
    <!--배너-->
    <div class="banner">
        <h1><i>DBpiaje</i>-커뮤니티🕓</h1>
    </div>


    <!-- 사이드바 toggle 버튼 -->
    <button id="toggleSidebar" class="sidebar-toggle">☰</button>

    <!--메뉴-->
    <aside id="sidebar" class="sidebar">
        <h3>ㅤ</h3>
        <a class="menu-button" href="index.html">🏠홈</a>
        <a class="menu-button" href="paper.html">📄논문</a>
        <a class="menu-button" href="community.html">💬공식 커뮤니티</a>
        <a class="menu-button" href="ask.html">❓문의</a>
        <a class="menu-button" href="patch_note.html">📝패치 노트</a>

        <!-- 다크모드 토글 버튼 -->
        <div class="toggle-container">
            <label class="switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="slider round"></span>
            </label>
            <span class="toggle-label">다크모드🌙</span>
        </div>
    </aside>

    <!--노래 틀기-->
    <!-- 접기/펼치기 토글 버튼 -->
    <button id="toggle-music-bar" class="collapse-btn">🎵 노래 메뉴 접기/펼치기</button>

    <div id="music-bar" class="music-bar collapsed">
        <div class="progress-container">
            <span id="current-time">0:00</span>
            <input type="range" id="progress-bar" value="0" min="0" max="100" step="1">
            <span id="duration">0:00</span>
        </div>
        <span>🎵 노래 선택:</span>
        <button class="song-btn" data-src="music_file/ Gill Chang Danni Carra - Why Do I Try .mp3">1. [Gill Chang Danni
            Carra] Why Do I Try</button>
        <button class="song-btn" data-src="music_file/Annalise - Nothing's Gonna Stop Us Tonight.mp3">2. [Initial D]
            Nothing's Gonna Stop Us Tonight</button>
        <button class="song-btn" data-src="music_file/Bamboo Bimbo _ Kiss.mp3">3. [Initial D] Kiss</button>
        <button class="song-btn" data-src="music_file/Manuel - Gas Gas Gas.mp3">4. [Initial D] gas gas gas</button>
        <button class="song-btn" data-src="music_file/예아2.wav">5. 예아</button>
        <!--<button class="song-btn" data-src="music_file/괘씸하거든여.wav">6. 괘씸하거든요</button>-->
        <!--<button class="song-btn" data-src="music_file/야기분좋다.wav">7. 기분 좋다</button>-->


        <span id="now-playing">
            ▶ 재생 중: <span id="current-song">없음</span>
            <span class="note-animation">🎵</span>
        </span>

        <button id="toggle-play" style="margin-left: 10px;">⏸ 멈춤</button>
    </div>

    <audio id="audio-player" controls style="display: none;"></audio>

    <!--<h1 style="text-align: center; font-size: 40px;">🔨현재 개발 중인 페이지 입니다</h1>-->


    <!-- 관리자 로그인/로그아웃 버튼 -->
    <div id="topBar" style="display: flex; justify-content:  flex-end; padding: 10px;">
        <button id="adminLoginBtn">관리자 로그인</button>
        <button id="adminLogoutBtn" style="display:none;">관리자 로그아웃</button>
    </div>

    <!-- 관리자 로그인 팝업 -->
    <div id="adminLoginPopup"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000;">
        <div style="background:white; padding:20px; border-radius:8px;">
            <p style="color: red;">관리자 비밀번호 입력:</p>
            <input type="password" id="adminLoginPwdInput" />
            <div style="margin-top: 10px;">
                <button id="confirmAdminLoginBtn">로그인</button>
                <button id="cancelAdminLoginBtn">취소</button>
            </div>
        </div>
    </div>


    <!-- 글 목록 위에 추가 -->
    <div style="max-width: 800px; margin: 20px auto; text-align: center;">
        <input type="text" id="searchInput" placeholder="검색어 입력" style="width: 60%; padding: 8px;">
        <button id="searchBtn" style="padding: 8px 16px;">검색</button>
        <button id="resetSearchBtn" style="padding: 8px 16px;">초기화</button>
    </div>

    <!-- 최신순/오래된 순 -->
    <div class="sort-buttons">
        <button id="sortRecentBtn" class="active">최신순</button>
        <button id="sortOldBtn">오래된순</button>
    </div>

    <!-- 게시물 -->
    <!-- 글쓰기 버튼 -->
    <div style="text-align:center; margin: 20px 0;">
        <button id="showWriteFormBtn" class="collapse-btn">글쓰기</button>
    </div>

    <!-- 글쓰기 폼 (처음엔 숨김) -->
    <div id="writeForm"
        style="display:none; max-width:600px; margin: 0 auto; padding: 10px; border: 1px solid #ccc; border-radius: 8px;">
        <label for="authorInput">작성자 이름:</label><br>
        <input type="text" id="authorInput" placeholder="작성자 이름 입력"
            style="width:100%; padding:8px; margin-bottom:10px;"><br>

        <label for="titleInput">제목:</label><br>
        <input type="text" id="titleInput" placeholder="제목 입력" style="width:100%; padding:8px; margin-bottom:10px;"><br>

        <label for="contentInput">글 내용:</label><br>
        <textarea id="contentInput" placeholder="글을 작성하세요" rows="5"
            style="width:100%; padding:8px; margin-bottom:10px;"></textarea><br>

        <!-- 이미지 업로드 -->
        <div id="imageUploadWrapper">
            <label for="imageInput" class="custom-file-label">파일 선택</label>
            <input type="file" id="imageInput" accept="image/*" />
        </div>
        <button id="addImageBtn" type="button" style="margin-bottom: 10px;">＋ 사진 추가</button>
        <button id="postBtn" class="collapse-btn" style="width:100%;">올리기</button>
    </div>

    <!-- 게시물 렌더링 -->
    <ul id="postsList"></ul>

    <!-- 삭제 팝업 --> <!-- 이거 사용은 안하고 있는데 지우면 버그남(관리자 로그인 불가)-->
    <div id="deletePopup"
        style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.6); z-index:9999; justify-content:center; align-items:center;">
        <div style="background:#fff; padding:20px; border-radius:8px; max-width:300px; width:90%;">
            <h3 style="color: red;">게시물 삭제</h3>
            <p style="color: red;">관리자 비밀번호를 입력하세요: </p>
            <p style="color: rgb(255, 0, 0)">(게시물 작성자는 삭제 문의를 부탁드립니다.)</p>
            <input type="password" id="adminPwdInput" style="width:100%; padding:8px; margin-bottom:10px;"
                placeholder="비밀번호">
            <div style="text-align:right;">
                <button id="cancelDeleteBtn" class="collapse-btn"
                    style="background:#ccc; color:#333; margin-right:8px;">취소</button>
                <button id="confirmDeleteBtn" class="collapse-btn" style="background:#d33;">삭제</button>
            </div>
        </div>
    </div>

    <!-- 공지사항 팝업 모달 창 -->
    <div id="firstVisitPopup" class="popup-overlay">
        <div class="popup-box">
            <h2>💬 커뮤니티 페이지</h2>
            <p style="color: red; font-size: 22px;">규칙을 꼭 읽어주세요</p>
            <p style="background-color: #bbbbbb; color:#000000; font-size: 20px;">1. 비방/정치/저격의 게시물은 삭제 대상입니다.</p>
            <p style="background-color: #bbbbbb; color: #000000; font-size: 20px;">2. 게시물의 내용은 자유입니다. <br> 논문을 작성해도
                좋습니다.</p>
            <p style="background-color: #bbbbbb; color: #000000; font-size: 20px;">3. [관리자 사칭 금지!] 진짜 관리자 이름: Admin</p>
            <p style="color: #000000; background-color: #bbbbbb; font-size: 20px;">-사진 업로드 기능 관련-<br>사진 업로드 기능은 "9월 29일"
                까지 이용가능합니다.<br>사진 업로드는 시간이 조금 걸리며, 텍스트로 된 주소가 나와도 그대로 업로드 하시면 됩니다.</p>
            <!--<p style="color: #000000; background-color: #bbbbbb; font-size: 20px;">죄송합니다. 현재 사진 업로드 기능은 버그로 작동하지 않습니다.</p>-->
            <b style="background-color: #bbbbbb; color: #1976d2; font-size: 17px;">페이지 상단에서 음악 재생 기능을 사용할 수 있어요!</b>

            <div>
                <button id="popup-close">닫기</button>
                <button id="popup-dont-show">오늘 하루 보지 않기</button>
            </div>
        </div>
    </div>


    <!-- 푸터 -->
    <footer class="footer">
        <p>ⓒ 2025 DBpiaje. All rights reserved.</p>
        <p>문의: dbpiaje@gmail.com</p>
    </footer>
    <script src="javascript/sidebar.js"></script>

    <!--노래 틀기 스크립트-->
    <script src="communityPage/js/musicplayer.js"></script>

    <!-- 게시물 기능 스크립트 -->

    <script type="module" src="communityPage/js/posts.js"></script>

    <!-- 공지사항 팝업 스크립트 -->
    <script>
        const popupKey = "firstVisitPopupShown";
        const today = new Date().toDateString(); // 하루 기준

        document.addEventListener("DOMContentLoaded", () => {
            const savedDate = localStorage.getItem(popupKey);
            const popup = document.getElementById("firstVisitPopup");

            if (savedDate !== today) {
                popup.style.display = "flex";
            }

            document.getElementById("popup-close").addEventListener("click", () => {
                popup.style.display = "none";
            });

            document.getElementById("popup-dont-show").addEventListener("click", () => {
                localStorage.setItem(popupKey, today);
                popup.style.display = "none";
            });
        });
    </script>
</body>

</html>